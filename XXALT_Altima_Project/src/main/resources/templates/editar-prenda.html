<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org">

<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Agregars Prenda | Altima</title>
<link rel="icon" type="image/png" sizes="32x32"
	href="/dist/img/favicon.ico">
<!-- Tell the browser to be responsive to screen width -->
<meta name="viewport" content="width=device-width, initial-scale=1">
<!-- Font Awesome -->
<link rel="stylesheet" href="/plugins/fontawesome-free/css/all.min.css">
<!-- Icons Design -->
<link rel="stylesheet" href="/dist/css/font/flaticon.css">
<!-- Custom CSS -->
<link rel="stylesheet" href="/dist/css/custom.css">
<!--  Font generated by <a href="https://www.flaticon.com">flaticon.com</a>. <p>Under <a href="http://creativecommons.org/licenses/by/3.0/">CC</a>: <a data-file="036-zipper" href="https://www.flaticon.com/authors/smalllikeart">smalllikeart</a></p-->
<!-- Ionicons -->
<link rel="stylesheet"
	href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
<!-- overlayScrollbars -->
<link rel="stylesheet" href="/dist/css/adminlte.min.css">
<!-- Datatables Plugin-->
<link rel="stylesheet" href="/dist/css/jquery.dataTables.min.css">
<!-- Datatables Plugin-->
<link rel="stylesheet" href="/dist/css/dataTables.bootstrap4.min.css">
<!-- Google Font: Source Sans Pro -->
<link
	href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700"
	rel="stylesheet">
<!-- select2 -->
<link href="/dist/css/select2.min.css" rel="stylesheet" />
<!-- select2-bootstrap4-theme -->
<link href="/dist/css/select2-bootstrap4.css" rel="stylesheet">
</head>

<body class="hold-transition sidebar-mini layout-fixed sidebar-collapse">
	<!-- Site wrapper -->
	<div class="wrapper">
		<!-- Navbar -->
		<div th:insert="navegacion-nav"></div>
		<!-- /.navbar -->
		<!-- Modal -->
		<div th:insert="navegacion-logout"></div>
		<!-- Main Sidebar Container -->
		<div th:insert="navegacion-aside"></div>

		<!-- Content Wrapper. Contains page content -->
		<div class="content-wrapper">
			<!-- Content Header (Page header) -->
			<section class="content-header">
				<div class="container-fluid">
					<div class="row mb-2">
						<div class="col-sm-6">
							<h1>Editar Prenda</h1>
						</div>
						<div class="col-sm-6">
							<ol class="breadcrumb float-sm-right">
								<li class="breadcrumb-item"><a href="#">Dashboard</a></li>
								<li class="breadcrumb-item active">Prendas</li>
							</ol>
						</div>
					</div>
				</div>
				<!-- /.container-fluid -->
			</section>

			<!-- Main content -->
			<section class="content">
				<div class="container-fluid">
					<div class="row">
						<div class="col-12">
							<!-- Default box -->
							<div class="card">
								<div class="card-header bg-dark">
									<h3 class="card-title">Editar prenda</h3>
								</div>
								<div class="card-body">
									<div class="row">
										<section class="col-12">
											<ul class="nav nav-tabs flex-nowrap" role="tablist">
												<li role="presentation" class="nav-item"><a
													href="#step1" class="nav-link active" data-toggle="tab"
													aria-controls="step1" role="tab"><i
														class="fas fa-info-circle"></i>&nbsp;Datos generales</a></li>
												<li role="presentation" class="nav-item"><a
													href="#step2" class="nav-link disabled" data-toggle="tab"
													aria-controls="step2" role="tab"><i
														class="fas fa-file-alt"></i>&nbsp;Datos de
														confecci&oacute;n</a></li>
												<li role="presentation" class="nav-item"><a
													href="#step3" class="nav-link disabled" data-toggle="tab"
													aria-controls="step3" role="tab"><i
														class="flaticon-001-wool"></i>&nbsp;Materiales a usar</a></li>
												<li role="presentation" class="nav-item"><a
													href="#complete" class="nav-link disabled"
													data-toggle="tab" aria-controls="complete" role="tab"><i
														class="flaticon-019-pattern-1"></i>&nbsp;Piezas de
														patronaje</a></li>
											</ul>
											<!-- <form th:action="@{/prendas}" method="post"
												th:object="${disenio}">-->
												<div th:object="${prenda}">
												<input type="hidden" value="editar" id="accionPag"/>
												<div class="tab-content py-2">
													<div class="tab-pane active" role="tabpanel" id="step1">
														<div class="row">
															<div class="col-sm-12">
																<div class="form-group">
																	<label>Tipo de prenda</label> 
																	<select placeholder="Elige un tipo de prenda" id="TipoPrenda">
																		<option value=""></option>
																		<option th:each="familia: ${familias}" th:value="${familia[0]}" 
																		th:text="${familia[1]}" th:selected="${familia[0] == prenda.idFamiliaPrenda}"></option>
																	</select>
																</div>
															</div>
															<div class="col-sm-4">
																<div class="form-group">
																	<label style="font-size: 15px;">Nombre de la prenda</label> <input type="text" class="form-control" placeholder="Blusa" th:value="*{nombrePrenda}" id="NombrePrenda">
																</div>
															</div>
															<div class="col-sm-4">
																<div class="form-group">
																	<label style="font-size: 15px;">Descripci&oacute;n
																		de la prenda</label> <input type="text" class="form-control"
																		placeholder="CH9192" th:value="*{descripcionPrenda}" id="DescripcionPrenda">
																</div>
															</div>
															<div class="col-sm-4">
																<div class="form-group">
																	<label style="font-size: 15px;">Nota especial</label> <input
																		type="text" class="form-control" placeholder="CH9192"  th:value="*{notaEspecial}" id="NotaEspecial">
																</div>
															</div>
															<div class="col-sm-10">
																<div class="form-group">
																	<label>Detalle de la prenda</label>
																	<textarea class="form-control" rows="3"
																		placeholder="Enter ..." id="DetallePrenda" th:text="*{detallePrenda}"></textarea>
																</div>
															</div>
															<div class="col-sm-2" style="font-size: 15px;">
																<div class="form-group" style="margin-top: 45px;">
																	<div
																		class="custom-control custom-switch custom-switch-off-danger custom-switch-on-success">
																		<input type="checkbox" class="custom-control-input"
																			id="combi" th:checked="${prenda.combinacion == '1'}"> <label
																			class="custom-control-label" for="combi">Lleva
																			combinaci&oacute;n</label>
																	</div>
																</div>
																<div class="form-group">
																	<div
																		class="custom-control custom-switch custom-switch-off-danger custom-switch-on-success">
																		<input type="checkbox" class="custom-control-input"
																			id="ticket" th:checked="${prenda.imprimirEtiquetas == '1'}"> <label
																			class="custom-control-label" for="ticket">Imprimir
																			ticket</label>
																	</div>
																</div>
															</div>
														</div>
														
														<form th:action="@{/prendas}" method="POST" enctype="multipart/form-data" th:object="${disenio}" ><!-- Abre form de la imagen -->
														<input type="hidden" name="_csrf" id="token"  th:value="${_csrf.token}"/>
														
														
														<div class="row">
															<div class="col-sm-12">
																<div class="form-group p-3 border p-2 rounded m-3">
																	<div class="row">
																		<div class="col-sm-3 text-center pt-2 border-right">
																			<label for="mainImage1">
																				<img th:src="@{'/uploads/prendas/' + ${prenda.dibujoFrente}}" alt="Placeholder" id="blah1" class="placeholder img-thumbnail"
																				aria-describedby="imagePreviewHelp1" th:onerror="this.src='/dist/img/preview.png'"/></label> 
																				<small id="imagePreviewHelp1" class="form-text text-muted">Previsualizaci&oacute;n
																				de la imagen</small>
																		</div>
																		<div class="col">
																			<label for="mainImage1">Imagen frontal</label>
																			<div class="input-group mb-3">
																				<input type="file" class="form-control border p-1" id="file" name="file"/>
																				<div class="input-group-append">
																					<span class="input-group-text bg-danger text-danger pointer" id="clearUpload1">
																						<i class="fas fa-times"></i>
																					</span>
																				</div>
																			</div>
																			<small id="imageHelp1" class="form-text text-muted">Selecciona la foto que desea subir.</small>
																		</div>
																	</div>
																</div>
															</div>
															<div class="col-sm-12">
																<div class="form-group p-3 border p-2 rounded m-3">
																	<div class="row">
																		<div class="col-sm-3 text-center pt-2 border-right">
																			<label for="mainImage"><img th:src="@{'/uploads/prendas/' + ${prenda.dibujoEspalda}}" alt="Placeholder" id="blah2" class="placeholder img-thumbnail"
																				aria-describedby="imagePreviewHelp" th:onerror="this.src='/dist/img/preview.png'"/></label> 
																				<small id="imagePreviewHelp" class="form-text text-muted">Previsualizaci&oacute;n
																				de la imagen</small>
																		</div>
																		<div class="col">
																			<label for="mainImage">Imagen espalda/trasero</label>
																			<div class="input-group mb-3">
																				<input type="file" class="form-control border p-1" id="file2" name="file2"/>
																				<div class="input-group-append">
																					<span class="input-group-text bg-danger text-danger pointer" id="clearUpload">
																						<i class="fas fa-times"></i>
																					</span>
																				</div>
																			</div>
																			<small id="imageHelp" class="form-text text-muted">Selecciona la foto que desea subir.</small>
																		</div>
																	</div>
																</div>
															</div>
															<div class="form-group col-sm-12">
																<button type="button" class="btn btn-primary float-right" onclick="ValidarPrimerPestana()">Siguiente</button>	
																<button type="button" class="btn btn-primary next-step float-right" id="SiguientePrimeraPestana" style="display: none">Siguiente</button><br>
																<button type="submit" id="FormImagenes" style="border: none"></button>
															</div>
															<div class="form-group col-sm-12" id="AlertaPrimerPestana" style="display: none; color: red;">
																<div class="float-right">
																	<label>Debes llenar todos los campos correctamente.</label>
																</div>
															</div>
														</div>
														</form><!-- Cierra form de la imagen -->
													</div>
													
													
													<!-- Form de imagen Frente -->
														<form th:action="@{/prendas1}" method="POST" enctype="multipart/form-data" th:object="${disenio}" style="display: none">
															<div id="ContenedorFrente"></div>
															<button type="submit" id="FormImagenFrente" style="border: none"></button>
														</form>
														<!-- Form de imagen Frente -->
														
														<!-- Form de imagen Espalda -->
														<form th:action="@{/prendas2}" method="POST" enctype="multipart/form-data" th:object="${disenio}" style="display: none">
															<div id="ContenedorEspalda"></div>
															<button type="submit" id="FormImagenEspalda" style="border: none"></button>
														</form>
														<!-- Form de imagen Espalda -->
														
													<div class="tab-pane" role="tabpanel" id="step2">
														<div class="row">
															<div class="col-sm-6">
																<div class="form-group">
																	<label>Detalle de la confecci&oacute;n</label>
																	<textarea class="form-control" rows="6" th:field="*{detalleConfeccion}"
																		placeholder="Especificar" id="DetalleConfeccion"></textarea>
																</div>
															</div>
															<div class="col-sm-6">
																<div class="form-group">
																	<label>Marcadores</label>
																	<textarea class="form-control" rows="6" th:field="*{marcadores}"
																		placeholder="Especificar"  id="Marcadores"></textarea>
																</div>
															</div>
														</div>
														<div class="row float-right" >
														<ul class="float-right">	
															<li class="list-inline-item">
																<button type="button" class="btn btn-primary" onclick="ValidarSegundaPestana()">Siguiente</button>
																<button type="button" class="btn btn-primary next-step" style="display: none" id="SiguienteSegundaPestana">Siguiente</button>
															</li>
														</ul>
														</div><br><br><br>
														<div class="row float-right" id="AlertaSegundaPestana" style="display: none; color: red;">
														<ul class="float-right">
															<li class="list-inline-item">
																<div class="float-right">
																	<label>Debes llenar todos los campos correctamente.</label>
																</div>
															</li>
														</ul>
														</div>
													</div>
													<div class="tab-pane" role="tabpanel" id="step3">
														<div class="row">
															<div class="col-sm-10">
																<div class="form-group">
																	<label>Lista de materiales</label>
																	<select placeholder="Elige una prenda" id="ListaDeMateriales">
																			<option th:each="materiales : ${materiales}" th:value="${materiales[0]}" th:text="${materiales[1]}"></option>
																	</select>
																</div>
															</div>
															<div class="col-sm-2">
																<label>&nbsp;</label>
																<div class="form-group">
																<!-- añadir a clas btn-block -->
																	<button class="btn btn-primary" onclick="AgregarElementoListaMateriales()" id="AgregarElementoMaterial">
																		<i class="fas fa-plus fa-sm"></i> Agregar
																	</button>
																</div>
															</div>
															<div class="col-md-12">
																<table class="table table-striped table-bordered">
																	<thead>
																		<tr>
																			<th scope="col">Clave AMP</th>
																			<th scope="col">Nombre</th>
																			<th scope="col">Clasificaci&oacute;n</th>
																			<th scope="col">Tama&ntilde;o</th>
																			<th scope="col">Modelo</th>
																			<th scope="col">Proceso</th>
																			<th scope="col">Cantidad</th>
																			<th scope="col"></th>
																		</tr>
																	</thead>
																	<tbody id="CuerpoTablaMateriales">
																	
																	<tr th:each="mat: ${materialesPrenda}">
																			<td th:text="${mat[1]}"></td>
																			<td scope='row' th:text="${mat[2]}"></td>
																			<td th:text="${mat[3]}"></td>
																			<td th:text="${mat[4] + ' ' +mat[5]}"></td>
																			<td th:text="${mat[6]}"></td>
																			<td th:text="${mat[7]}"></td>
																			<td><input type="number" class="form-control"/></td>
																			<td>
																				<button class="btn btn-danger rounded-circle" th:onclick="EliminarMaterialExistente(${mat[8]})">
																					<i class='fas fa-minus fa-sm'></i>
																				</button>
																			</td>
																		</tr>
																		
																	</tbody>
																</table>
															</div>
														</div>
														<!-- <ul class="float-right">
															<li class="list-inline-item">
															
																<button type="button" class="btn btn-outline-primary next-step">Siguiente</button>
															</li>
														</ul> -->
													<div class="row float-right" >
														<ul class="float-right">	
															<li class="list-inline-item">
																<button type="button" class="btn btn-primary" th:onclick="ValidarTerceraPestana2('${prenda.idPrenda}')">Siguiente</button>
																<button type="button" class="btn btn-primary next-step" style="display: none" id="SiguienteTerceraPestana">Siguiente</button>
															</li>
														</ul>
														</div><br><br><br>
														<div class="row float-right" id="AlertaTerceraPestana" style="display: none; color: red;">
														<ul class="float-right">
															<li class="list-inline-item">
																<div class="float-right">
																	<label>Debes agregar al menos un material.</label>
																</div>
															</li>
														</ul>
													</div>
													</div>
													<div class="tab-pane" role="tabpanel" id="complete">
														<div class="row">
															<div class="col-sm-12">
																<div class="form-group">
																	<label>Lista de piezas de patronaje</label> <select
																		placeholder="Elige una prenda" id="ListaPatronaje">
																		<option th:each="patronajes : ${patronajes}" th:value="${patronajes[0]}" th:text="${patronajes[2]}"></option>
																	</select>
																</div>
															</div>
															<div class="col-sm-3">
																<label>Cantidad de tela</label>
																<div class="form-group">
																	<input type="text" class="form-control"
																		placeholder="10" id="CantidadTela">
																</div>
															</div>
															<div class="col-sm-3">
																<label>Cantidad de forro</label>
																<div class="form-group">
																	<input type="text" class="form-control"
																		placeholder="10"  id="CantidadForro">
																</div>
															</div>
															<div class="col-sm-3">
																<label>Cantidad de entretela</label>
																<div class="form-group">
																	<input type="text" class="form-control"
																		placeholder="10"  id="CantidadEntretela">
																</div>
															</div>
															<div class="col-sm-3">
																<label>&nbsp;</label>
																<div class="form-group">
																	<div id="BotonAgregar" style="display: block">
																		<button class="btn btn-primary btn-block" onclick="ValidarCantidadesPatronaje()" id="BotonAgregarPatronaje">
																			<i class="fas fa-plus fa-sm"></i> Agregar
																		</button>
																	</div>
																	<div id="BotonEditar" style="display: none">
																		<button class="btn btn-warning btn-block" onclick="ValidarCantidadesPatronaje2()" id="BotonAgregarPatronaje">
																			<i class="fas fa-edit fa-sm"></i> Editar
																		</button>
																	</div>
																</div>
															</div>
															<div class="col-md-12">
																<table class="table table-striped table-bordered">
																	<thead>
																		<tr>
																			<th scope="col">No. Material</th>
																			<th scope="col">Nombre</th>
																			<th scope="col">Cantidad de tela</th>
																			<th scope="col">Cantidad de forro</th>
																			<th scope="col">Cantidad de entretela</th>
																			<th scope="col">Editar</th>
																			<th scope="col">Quitar</th>
																		</tr>
																	</thead>
																	<tbody id="CuerpoPatronaje">
																	
																	<tr th:each="pat: ${patronajesPrenda}" th:id="${pat[1]}">
																			<th scope="row" th:text="${pat[1]}"></th>
																			<td th:text="${pat[2]}"></td>
																			<td th:text="${pat[3]}"></td>
																			<td th:text="${pat[4]}"></td>
																			<td th:text="${pat[5]}"></td>
																			<td class="tdcenter">
																				<button class="btn btn-warning rounded-circle" th:onclick="'EditarPatronajeExistente(\'' + ${pat[0]} + '\');'">
																					<i class='fas fa-edit fa-sm'></i>
																				</button>
																			</td>
																			<td class="tdcenter">
																				<button class="btn btn-danger rounded-circle" th:onclick="'EliminarPatronajeExistente(\'' + ${pat[0]} + '\');'">
																					<i class='fas fa-minus fa-sm'></i>
																				</button>
																			</td>
																		</tr>
																	
																	</tbody>
																</table>
															</div>
														</div>
														
													<div class="row float-right" >
														<ul class="float-right">	
															<li class="list-inline-item">
																<button type="button" class="btn btn-primary" onclick="ValidarCuartaPestana2()">Guardar</button>
																<button type="button" class="btn btn-primary next-step" style="display: none" id="SiguienteCuartaPestana" onclick="Guardar()">Guardar</button>
															</li>
														</ul>
														</div><br><br><br>
														<div class="row float-right" id="AlertaCuartaPestana" style="display: none; color: red;">
														<ul class="float-right">
															<li class="list-inline-item">
																<div class="float-right">
																	<label>Debes agregar al menos un elemento.</label>
																</div>
															</li>
														</ul>
													</div>
													<div class="row float-right" id=AlertaCantidadesPatronaje style="display: none; color: red !important">
														<ul class="float-right">
															<li class="list-inline-item">
																<div class="float-right">
																	<label>Debes agregar las cantidades.</label>
																</div>
															</li>
														</ul>
													</div>
													</div>
													<div class="clearfix"></div>
												</div>
											</form>
										</section>
									</div>
								</div>
								<!-- /.card-body -->
							</div>
							<!-- /.card -->
						</div>
					</div>
				</div>
			</section>
			<!-- /.content -->
		</div>
		<!-- /.content-wrapper -->

		<div th:insert="navegacion-footer"></div>
	</div>
	<!-- ./wrapper -->

	<!-- jQuery -->
	<script src="/plugins/jquery/jquery.min.js"></script>
	<!-- Bootstrap 4 -->
	<script src="/plugins/bootstrap/js/bootstrap.bundle.min.js"></script>
	<!-- Datatables Plugin-->
	<script src="/dist/js/jquery.dataTables.min.js"></script>
	<script src="/dist/js/dataTables.buttons.min.js"></script>
	<script src="/dist/js/buttons.colVis.min.js"></script>
	<!-- Bootstrap Datatables Plugin-->
	<script src="/dist/js/dataTables.bootstrap4.min.js"></script>
	<!-- AdminLTE App -->
	<script src="/dist/js/adminlte.min.js"></script>
	<!-- AdminLTE for demo purposes -->
	<script src="/dist/js/demo.js"></script>
	<script src="/dist/js/TablaPrenda.js"></script>
	<script src="/dist/js/UploadImage.js"></script>
	<!-- select2 -->
	<script src="/dist/js/select2.min.js"></script>
	<!-- Script para guardar Prenda -->
	<script src="/dist/js/AgregarPrenda.js"></script>
	<script th:inline="javascript">
	/*<![CDATA[*/
	var message = /*[[${prenda}]]*/ 'default';
	var materiales = /*[[${materialesPrenda}]]*/ 'default';
	var patronajes = /*[[${patronajesPrenda}]]*/ 'default';
	
	function AsignarID()
	{
		//Solicitud Ajax
	    $.ajax({
	        type: "GET",
	        url: "/asignar_id",
	        data: {
	        	"_csrf": $('#token').val(),
	        	"id" : message.idPrenda
	        },
	        success: (data) => {
	        	console.log(data);        	
			},
			failure: function(errMsg) {
		        alert(errMsg);
		    }
		});
	}
	
	//Se almacenan en un array de objetos los materiales
	console.log(materiales);
	var ides = [];
	for(i = 0; i < materiales.length; i++)
	{
		var temp = {id: materiales[i][0], nombre: materiales[i][1]}
		ides.push(temp);
	}
	
	//Se almacenan en un array de objetos los patronajes
	console.log(patronajes);
	var ides2 = [];
	for(i = 0; i < patronajes.length; i++)
	{
		var temp = {id: patronajes[i][0], idText: patronajes[i][1],cantidadTela: patronajes[i][3], cantidadForro: patronajes[i][4], cantidadEntretela: patronajes[i][5], idPatronaje: patronajes[i][6]};
		ides2.push(temp);
	}
	
	/*]]>*/
	</script>
	<script>
		function changeClassById() {
			document.getElementById("menuDiseno").className = "nav-item has-treeview menu-open";
			document.getElementById("navDiseno").className = "nav-link active";
			document.getElementById("navDiseno2").className = "nav-link active";
		}
		window.onload = changeClassById();
	</script>
	<script>
		$(document).ready(
				function() {
					//Initialize tooltips
					$('.nav-tabs > li a[title]').tooltip();

					//Wizard
					$('a[data-toggle="tab"]').on('show.bs.tab', function(e) {
						var $target = $(e.target);
						if ($target.parent().hasClass('disabled')) {
							return false;
						}
					});

					$(".next-step").click(
							function(e) {
								var $active = $('.nav-tabs li>.active');
								$active.parent().next().find('.nav-link')
										.removeClass('disabled');
								nextTab($active);
							});

					$(".prev-step").click(function(e) {
						var $active = $('.nav-tabs li>a.active');
						prevTab($active);
					});
				});

		function nextTab(elem) {
			$(elem).parent().next().find('a[data-toggle="tab"]').click();
		}
		function prevTab(elem) {
			$(elem).parent().prev().find('a[data-toggle="tab"]').click();
		}
	</script>
	<script>
		$(function() {
			$('select').each(function() {
				$(this).select2({
					theme : 'bootstrap4',
					width : 'style',
					placeholder : $(this).attr('placeholder'),
					allowClear : Boolean($(this).data('allow-clear')),
				});
			});
		});
	</script>
	<script>
	
		//Objetoa ser llenado para almacenar
		objeto_prenda = {};
		objeto_materiales = [];
		objeto_patronaje = [];
		
		var CambiarImgFrente = false;
		var CambiarImgEspalda = false;
	
	</script>
</body>

</html>
